<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0014)about:internet -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="search-keywords" content="Event Console" />
<meta http-equiv="Content-Language" content="en-US" />
<meta name="generator" content="Adobe RoboHelp 8" />
<title>Configuring Consolidation</title>
<link rel="StyleSheet" href="../../Bookshelf.css" type="text/css" />
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function ehlp_showtip(current,e,text)
{
  if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == 'Netscape'))
  {
    document.tooltip.document.write("<layer bgColor='yellow' style='border:1px solid black;font-size:12px;'>"+ text + "<\/layer>");
    document.tooltip.document.close();
    document.tooltip.left=e.pageX+5;
    document.tooltip.top=e.pageY+5;
    document.tooltip.visibility="show";
  }
}
function ehlp_hidetip()
{
  document.tooltip.visibility="hidden";
}
//]]>
</script>
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
        origWidth = innerWidth;
        origHeight = innerHeight;
        onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
/*<![CDATA[*/
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
-->
/*]]>*/
</style>

<script type="text/javascript" language="javascript1.2" src="../../whmsg.js">
</script>
<script type="text/javascript" language="javascript" src="../../whver.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../../whproxy.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../../whutils.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../../whlang.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../../whtopic.js">
</script>
</head>
<body>
<script type="text/javascript" language="javascript1.2">
//<![CDATA[
<!--
if (window.gbWhTopic)
{
        var strUrl = document.location.href;
        var bc = 0;
        var n = strUrl.toLowerCase().indexOf("bc-");
        if(n != -1)
        {
                document.location.href = strUrl.substring(0, n);
                bc = strUrl.substring(n+3);
        }

        if (window.addTocInfo)
        {
        addTocInfo("DEVELOPER REFERENCE\nFoundation\nConfiguring Consolidation");
addButton("show",BTN_TEXT,"Show Table of Contents","","","","",0,0,"","","");

        }
        if (window.writeBtnStyle)
                writeBtnStyle();

        if (window.writeIntopicBar)
                writeIntopicBar(1);

        
        

        if (window.setRelStartPage)
        {
        setRelStartPage("../../Bookshelf.htm");

                autoSync(0);
                sendSyncInfo();
                sendAveInfoOut();
        }
}
else
        if (window.gbIE4)
                document.location.reload();

//-->
//]]>
</script><script type="text/javascript" language="javascript">
//<![CDATA[
document.write("<p  style=\"text-align:right;color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;\">");
AddMasterBreadcrumbs("../../Bookshelf.htm", "color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;", "&gt;", "Home", "../../Welcome_to_GroundWork_Monitor/index.htm");
document.write("<a style=\"color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;\" href=\"../developer_aboutdeveloperreference.htm\">DEVELOPER REFERENCE<\/a> &gt; <a style=\"color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;\" href=\"developer_foundationoverview.htm\">Foundation<\/a> &gt; Configuring Consolidation<\/p>");
//]]>
</script>
<p>&#160;</p>
<h1>GroundWork Foundation</h1>
<h3 align="right"><a href="../developer_aboutdeveloperreference.htm" title="Topic Home" onmouseover="if ((parseInt(navigator.appVersion) == 4) &amp;&amp; (navigator.appName == 'Netscape')) ehlp_showtip(this,event,'Topic Home');" onmouseout="if ((parseInt(navigator.appVersion) == 4) &amp;&amp; (navigator.appName == 'Netscape')) ehlp_hidetip();"></a> <a href="mailto:support@groundworkopensource.com?subject=Configuring Consolidation" title="Send Comments"></a></h3>
<h2>Configuring Consolidation</h2>
<h3>How It Works</h3>
<p>The Foundation consolidation feature allows you to reduce the number of <span class="Code">LogMessages</span> by creating just one entry for messages that are alike, incrementing the Message counter, and adjusting the date fields. Consolidation processing is applied to all incoming messages of <span class="Code">Entity Type</span> LogMessage where the attribute consolidation is defined (e.g. <span class="Code">consolidation='SNMPTRAP'</span>).</p>
<p>Consolidation criteria is stored in the database and consists of a user definable <span style="font-style: italic;"><i>Name</i></span> and the <span style="font-style: italic;"><i>Criteria</i></span>. The criteria is a semicolon (;) separated list of <span class="Code">LogMessage</span> record fields or <span class="Code">PropertyName</span>. For an incoming message to be consolidated, all values of the fields defined in the <span style="font-style: italic;"><i>Criteria</i></span> have to match an existing record.</p>
<p>An incoming message must define the <span style="font-style: italic;"><i>Name</i></span> of the consolidation criteria that it will be matched against. If the consolidation tag is missing, a new log entry is created, which is the system's default behavior.</p>
<h3>Default Consolidation</h3>
<p>By default, the consolidation is turned on for <span style="font-style: italic;"><i>Nagios</i></span>, <span style="font-style: italic;"><i>SNMP</i></span>, and <span style="font-style: italic;"><i>Syslog</i></span> event processing. Consolidation will occur if the fields defined in the consolidation criteria match. An exception to the above is if the <span style="font-style: italic;"><i>Monitoring Status</i></span> of the last event is different than the <span style="font-style: italic;"><i>Monitoring Status</i></span> of the incoming event, a new console message will be created. This rule guarantees that console messages sorted by chronological order will always show the current status above previous status. The following consolidation criteria is defined in Foundation's <span class="Code">ConsolidationCriteria</span> table. An Administrator can update consolidation criteria entries to the consolidation criteria table within <span style="font-style: italic;"><i>GroundWork Monitor</i></span> <span style="font-weight: bold;"><b>Administration</b></span>&gt;<span style="font-weight: bold;"><b>Foundation</b></span>&gt;<span style="font-weight: bold;"><b>Manage Consolidation Criteria</b></span>. Here you will find existing consolidation criteria and a place to enter and add new criteria.</p>
<p class="Caption">Table: Consolidation Criteria</p>
<table cellspacing="0" width="700">
<col style="width: 20%;" />
<col style="width: 60%;" />
<col style="width: 20%;" />
<tr style="vertical-align: top;">
<td style="border: Solid 2px #ffffff; padding-right: 10px; padding-left: 10px;" bgcolor="#1B3A83">
<p class="NormalTableBold">Name</p>
</td>
<td style="border-top: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; padding-right: 10px; padding-left: 10px;" bgcolor="#1B3A83">
<p class="NormalTableBold">Criteria</p>
</td>
<td style="border-top: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; padding-right: 10px; padding-left: 10px;" bgcolor="#1B3A83">
<p class="NormalTableBold">Feeder</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">NAGIOSEVENT</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">Device;MonitorStatus;OperationStatus;SubComponent;ErrorType</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">&#160;</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">SYSTEM</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">OperationStatus;Device;MonitorStatus;ApplicationType;TextMessage</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">EventBroker</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">SNMPTRAP</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable" style="margin-top: 0pt; margin-bottom: 0pt;">OperationStatus;Device;ipaddress;MonitorStatus;Event_OID_numeric;</p>
<p class="NormalTable" style="margin-top: 0pt; margin-bottom: 0pt;">Event_Name;Category;Variable_Bindings</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">snmptt forwarding traps to Foundation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">SYSLOG</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">OperationStatus;Device;MonitorStatus;ipaddress;ErrorType;SubComponent</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">gw-syslog-feeder.pl</p>
</td>
</tr>
</table>
<p class="Caption">Figure: Updating Consolidation Criteria</p>
<p class="Figure"><img src="../Assets/developer_consolidationcriteria.gif" alt="developer_consolidationcriteria.gif" style="border: none;" width="700" height="358" border="0" /></p>
<h3>Disable Consolidation</h3>
<p>To disable consolidation for the <span style="font-style: italic;"><i>Feeders</i></span> shipped with <span style="font-style: italic;"><i>GroundWork Monitor</i></span>, you can modify the <span style="font-style: italic;"><i>Nagios</i></span> event log feeder, <span class="Code">nagios2collage_eventlog.pl</span>, to send a message to <span style="font-style: italic;"><i>Foundation</i></span> that does not specify consolidation. Change the script that contains the following line:</p>
<p class="CodeGroup">my $xml_message = "&lt; NAGIOS_LOG consolidation='NAGIOSEVENT'"; # Start message tag. Consolidation is ON</p>
<p>To the following:</p>
<p class="CodeGroup">my $xml_message = "&lt; NAGIOS_LOG "; # Start message tag. Consolidation is now turned OFF</p>
<h3>Example</h3>
<p>To enable consolidation, the event message needs to look like the following, followed by the other arguments:</p>
<p class="CodeGroup">&lt;NAGIOS_LOG consolidation='NAGIOSEVENT' &#160;</p>
<p>The Consolidation Criteria in the database for <span style="font-style: italic;"><i>NAGIOSEVENT</i></span> defines the following criteria:</p>
<p class="CodeGroup">Device;MonitorStatus;OperationStatus;SubComponent;ErrorType</p>
<p>If an event is fed to the system and the consolidation criteria is defined, the system checks if any log message for the <span style="font-style: italic;"><i>Device</i></span>, <span style="font-style: italic;"><i>MonitorStatus</i></span>, <span style="font-style: italic;"><i>OperationStatus</i></span>, <span style="font-style: italic;"><i>SubComponent</i></span> and <span style="font-style: italic;"><i>ErrorType</i></span> &#160;already exists. The system will only consolidate if:</p>
<ul style=" list-style:url('');">
<li class="p-Bullet1">
<p class="Bullet1">just one LogMessage object matches</p>
</li>
<li class="p-Bullet1">
<p class="Bullet1">if multiple LogMessage objects match a warning is logged indicating that the criteria needs to be better defined</p>
</li>
</ul>
<p>If a match is found an existing message the message counter <span class="Code">LogMessage.MsgCount</span> for an existing message will be incremented and the date fields will be updated as follows:</p>
<table cellspacing="0" width="700">
<col style="width: 20%;" />
<col style="width: 80%;" />
<tr style="vertical-align: top;">
<td style="border: Solid 2px #ffffff; width: 50%; padding-right: 10px; padding-left: 10px;" bgcolor="#1B3A83">
<p class="NormalTableBold">Database Field</p>
</td>
<td style="border-top: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 50%; padding-right: 10px; padding-left: 10px;" bgcolor="#1B3A83">
<p class="NormalTableBold"><span style="font-weight: bold;"><b>Change Applied</b></span></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 50%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">FirstInsertDate</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 50%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">unchanged</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 50%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">LastInsertDate</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 50%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">ReportDate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 50%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">ReportDate</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 50%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">System (current time)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 50%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">TextMessage</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 50%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="NormalTable">Updated Text message. Text Message might include the values of a check (85% disk used) that changes while the status and the type remain the same.</p>
</td>
</tr>
</table>
<div style="width: 100%; position: relative;" id="footer">
<p class="Footer" style="font-size: 7pt; line-height: Normal; margin-top: 6pt; margin-bottom: 4pt;">GroundWork, Inc. ©2011</p>
</div>
<script type="text/javascript" language="JavaScript">
//<![CDATA[
 if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == 'Netscape'))
  document.write("<div id='tooltip' class='WebHelpPopupMenu'><\/div>");
//]]>
</script><script type="text/javascript" language="javascript1.2">
//<![CDATA[
<!--
if (window.writeIntopicBar)
        writeIntopicBar(0);


highlightSearch();
//-->
//]]>
</script>
</body>
</html>
