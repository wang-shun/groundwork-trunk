<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0014)about:internet -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Adobe RoboHelp 8" />
<title>WMI IIS</title>
<link rel="StyleSheet" href="../../Bookshelf.css" type="text/css" />
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
        origWidth = innerWidth;
        origHeight = innerHeight;
        onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
/*<![CDATA[*/
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
-->
/*]]>*/
</style>

<script type="text/javascript" language="javascript1.2" src="../../whmsg.js">
</script>
<script type="text/javascript" language="javascript" src="../../whver.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../../whproxy.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../../whutils.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../../whlang.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../../whtopic.js">
</script>
</head>
<body>
<script type="text/javascript" language="javascript1.2">
//<![CDATA[
<!--
if (window.gbWhTopic)
{
        var strUrl = document.location.href;
        var bc = 0;
        var n = strUrl.toLowerCase().indexOf("bc-");
        if(n != -1)
        {
                document.location.href = strUrl.substring(0, n);
                bc = strUrl.substring(n+3);
        }

        if (window.addTocInfo)
        {
        addTocInfo("GROUNDWORK PROFILES\nWMI Profiles\nWMI IIS");
addButton("show",BTN_TEXT,"Show Table of Contents","","","","",0,0,"","","");

        }
        if (window.writeBtnStyle)
                writeBtnStyle();

        if (window.writeIntopicBar)
                writeIntopicBar(1);

        
        

        if (window.setRelStartPage)
        {
        setRelStartPage("../../Bookshelf.htm");

                autoSync(0);
                sendSyncInfo();
                sendAveInfoOut();
        }
}
else
        if (window.gbIE4)
                document.location.reload();

//-->
//]]>
</script><script type="text/javascript" language="JavaScript1.2" src="../../ehlpdhtm.js">
</script><script type="text/javascript" language="javascript">
//<![CDATA[
document.write("<p  style=\"text-align:right;color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;\">");
AddMasterBreadcrumbs("../../Bookshelf.htm", "color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;", "&gt;", "Home", "../../Welcome_to_GroundWork_Monitor/index.htm");
document.write("<a style=\"color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;\" href=\"../profiles_aboutprofiles.htm\">GROUNDWORK PROFILES<\/a> &gt; <a style=\"color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;\" href=\"profiles_wmicitrix.htm\">WMI Profiles<\/a> &gt; WMI IIS<\/p>");
//]]>
</script>
<p>&#160;</p>
<h1><a name="MiniTOCBookMark1" id="MiniTOCBookMark1"></a><img src="../../Shared_Images/square.gif" alt="square.gif" style="border: none;" width="15" height="15" border="0" /> GroundWork Profiles</h1>
<h3 align="right"><a href="../profiles_aboutprofiles.htm"><img src="../../Shared_Images/homeicon.gif" alt="homeicon.gif" style="border: none;" width="33" height="27" border="0" /></a> <img src="../../Shared_Images/printicon.gif" onclick="window.print()" alt="Print Page" title="Print Page" style="border: none;" width="31" height="27" border="0" /> <a href="mailto:support@groundworkopensource.com?subject=WMI IIS Profile" title="Send Comments"><img src="../../Shared_Images/commentsicon.gif" alt="commentsicon.gif" style="border: none;" width="33" height="27" border="0" /></a></h3>
<h2><a name="MiniTOCBookMark2" id="MiniTOCBookMark2"></a>WMI Internet Information services (IIS) Profile</h2>
<p align="left">Table&#160;of&#160;Contents:&#160;<a class="dropspot" href="javascript:TextPopup(this)" id="MTHotSpot52652" name="MTHotSpot52652"><span class="MTText">Show</span><span class="MTText" style="display: none;">Hide</span></a></p>
<script type="text/javascript" language="JavaScript1.2">
//<![CDATA[
TextPopupInit('MTHotSpot52652', 'MTPOPUP52652');
//]]>
</script>
<div align="left" class="droptext" id="MTPOPUP52652" style="display: none;">
<ul style="text-align:left; list-style-type: circle;">
<li><a href="#MiniTOCBookMark3">Services Configuration</a></li>
<li><a href="#MiniTOCBookMark4">Profile Package</a></li>
<li><a href="#MiniTOCBookMark5">Installation</a></li>
<li><a href="#MiniTOCBookMark6">Implementation</a></li>
</ul>
</div>
<p class="Bullet1">This profile monitors IIS services on a Windows server using Windows Management Instrumentation (WMI). Nagios Remote Plugin Executor (NRPE) is used by the Nagios server to communicate with the WMI proxy server. This proxy server queries the monitored Windows server for measurements and status using WMI.</p>
<p class="Bullet1">Additionally, you may want to refer to the <a href="../../Open_Source_Reference/GroundWork_OS_Projects/osr_wmiagentlesspluginsproject.htm">GroundWork WMI Agent-less Plugins Project</a> documentation, and the MonitoringForge site at <a href="http://monitoringforge.org/plugins/wmiagentlessplugins" target="_blank">http://monitoringforge.org/plugins/wmiagentlessplugins</a>. This project consists of a collection of script monitors (.vbs for starters) that use the Microsoft .Net Framework and WMI to retrieve performance data from remote Windows hosts without the need for agents on the remote hosts.</p>
<h3><a name="MiniTOCBookMark3" id="MiniTOCBookMark3"></a>Services Configuration</h3>
<ul style="list-style: url('../../Shared_Images/bullet01.gif');">
<li class="p-Bullet1">
<p class="Bullet1"><span style="font-weight: bold;"><b>SERVICE</b></span> - Definitions in Monarch are stored under this name.</p>
</li>
<li class="p-Bullet1">
<p class="Bullet1"><span style="font-weight: bold;"><b>COMMAND LINE</b></span> - Service command name with arguments to be passed to the plugin.</p>
</li>
<li class="p-Bullet1">
<p class="Bullet1"><span style="font-weight: bold;"><b>PLUGIN COMMAND LINE</b></span> - Plugin script called by Nagios for this Service.</p>
</li>
<li class="p-Bullet1">
<p class="Bullet1"><span style="font-weight: bold;"><b>EXTENDED INFO</b></span> - The Extended Service Info definition, typically used for generating graphs.</p>
</li>
</ul>
<p><span style="color: #ff0000; font-weight: bold;"><font color="red"><b>Note:</b></font></span> Command lines displayed below are intended to be single line commands.</p>
<table cellspacing="0" width="700">
<col style="width: 15%;" />
<col style="width: 35%;" />
<col style="width: 35%;" />
<col style="width: 15%;" />
<tr style="vertical-align: top;">
<td style="border: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#1B3A83">
<p class="NormalTableBoldCenter">Service</p>
</td>
<td style="border-top: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#1B3A83">
<p class="NormalTableBoldCenter">Command Line</p>
</td>
<td style="border-top: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#1B3A83">
<p class="NormalTableBoldCenter">Plugin Command Line</p>
</td>
<td style="border-top: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#1B3A83">
<p class="NormalTableBoldCenter">Extended Info</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">wmi_iis_bytes_received</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">check_wmi_iis_bytes_received!</p>
<p class="CourierTable">Name=_Total!6000!12000</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">$USER1$/check_nrpe -t 60 -H $USER21$ -c get_iis_bytes_received -a "$HOSTADDRESS$" "$ARG1$" "$ARG2$" "$ARG3$"</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">number_graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">wmi_iis_bytes_sent</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">check_wmi_iis_bytes_sent!</p>
<p class="CourierTable">Name=_Total!6000000!10000000</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">$USER1$/check_nrpe -t 60 -H $USER21$ -c get_iis_bytes_sent -a "$HOSTADDRESS$" "$ARG1$" "$ARG2$" "$ARG3$"</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">number_graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">wmi_iis_bytes_total</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">check_wmi_iis_bytes_total!</p>
<p class="CourierTable">Name=_Total!500000!600000</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">$USER1$/check_nrpe -t 60 -H $USER21$ -c get_iis_bytes_total -a "$HOSTADDRESS$" "$ARG1$" "$ARG2$" "$ARG3$"</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">number_graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">wmi_iis_current_connections</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">check_wmi_iis_current_connections!</p>
<p class="CourierTable">Name=_Total!200!400</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">$USER1$/check_nrpe -t 60 -H $USER21$ -c get_iis_currentconnections -a "$HOSTADDRESS$" "$ARG1$" "$ARG2$" "$ARG3$"</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">number_graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">wmi_iis_current_nonanonymous_users</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">check_wmi_iis_current_nonanonymous_users!</p>
<p class="CourierTable">Name=_Total!50!80</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">$USER1$/check_nrpe -t 60 -H $USER21$ -c get_iis_curnonanonusers -a "$HOSTADDRESS$" "$ARG1$" "$ARG2$" "$ARG3$"</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">number_graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">wmi_iis_get_requests</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">check_wmi_iis_get_requests!</p>
<p class="CourierTable">Name=_Total!200!400</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">$USER1$/check_nrpe -t 60 -H $USER21$ -c get_iis_get_requests -a "$HOSTADDRESS$" "$ARG1$" "$ARG2$" "$ARG3$"</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">number_graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">wmi_iis_maximum_connections</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">check_wmi_iis_maximum_connections!</p>
<p class="CourierTable">Name=_Total!50!60</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">$USER1$/check_nrpe -t 60 -H $USER21$ -c get_iis_maximumconnections -a "$HOSTADDRESS$" "$ARG1$" "$ARG2$" "$ARG3$"</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">number_graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">wmi_iis_post_requests</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">check_wmi_iis_post_requests!</p>
<p class="CourierTable">Name=_Total!200!400</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">$USER1$/check_nrpe -t 60 -H $USER21$ -c get_iis_post_requests -a "$HOSTADDRESS$" "$ARG1$" "$ARG2$" "$ARG3$"</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">number_graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">wmi_iis_private_bytes</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">check_wmi_iis_private_bytes!</p>
<p class="CourierTable">4000000!5000000</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">$USER1$/check_nrpe -t 60 -H $USER21$ -c get_iis_privatebytes -a "$HOSTADDRESS$" "$ARG1$" "$ARG2$"</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">number_graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">wmi_iis_total_not_found_errors</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">check_wmi_iis_total_not_found_errors!</p>
<p class="CourierTable">Name=_Total!500!600</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">$USER1$/check_nrpe -t 60 -H $USER21$ -c get_iis_totalnotfounderrors -a "$HOSTADDRESS$" "$ARG1$" "$ARG2$" "$ARG3$"</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">number_graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">wmi_service_Dfs</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">check_wmi_service!Dfs</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">$USER1$/check_nrpe -H $USER21$ -t 60 -c get_service -a "$HOSTADDRESS$" "$ARG1$"</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">percent_graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">wmi_service_IsmServ</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">check_wmi_service!IsmServ</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">$USER1$/check_nrpe -H $USER21$ -t 60 -c get_service -a "$HOSTADDRESS$" "$ARG1$"</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">percent_graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td style="border-left: Solid 2px #ffffff; border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">wmi_service_W3SVC</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">check_wmi_service!W3SVC</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 15%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">$USER1$/check_nrpe -H $USER21$ -t 60 -c get_service -a "$HOSTADDRESS$" "$ARG1$"</p>
</td>
<td style="border-right: Solid 2px #ffffff; border-bottom: Solid 2px #ffffff; width: 35%; padding-right: 10px; padding-left: 10px;" bgcolor="#C0C0C0">
<p class="CourierTable">percent_graph</p>
</td>
</tr>
</table>
<h3><a name="MiniTOCBookMark4" id="MiniTOCBookMark4"></a>Profile Package</h3>
<p>This package includes the following files:</p>
<p>Profile Definitions</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">service-profile-wmi-iis.xml</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">perfconfig-wmi-iis.xml</p>
</li>
</ul>
<p>Plugins Scripts on the GroundWork Monitor Server</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">check_nrpe</p>
</li>
</ul>
<p>WMI Scripts on the WMI Proxy Server</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">nrpe_nt.zip</p>
</li>
</ul>
<p>Performance Graphing Programs</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">number_graph.cgi</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">percent_graph.cgi</p>
</li>
</ul>
<h3><a name="MiniTOCBookMark5" id="MiniTOCBookMark5"></a>Installation</h3>
<p>GroundWork Monitor includes many monitoring profiles for a variety of devices, systems and applications. Profiles already imported on a new GroundWork installation include Service Ping, SNMP Network, and SSH UNIX. The GroundWork Monitor Configuration tool is used to import updated Profiles and Profiles that require additional setup; the Profile XML file and its companion Performance Configuration definition file. Services can also be imported in addition to Service Profiles in the Profile Importer. The import process is documented under <span style="font-weight: bold;"><b>GROUNDWORK PROFILES &gt; <a href="../profiles_importingprofiles.htm" style="font-weight: bold;">Importing Profiles</a></b></span>.</p>
<h3><a name="MiniTOCBookMark6" id="MiniTOCBookMark6"></a><b style="font-weight: bold;">Implementation</b></h3>
<p><b style="font-weight: bold;">T</b>his section contains detail settings used by this Profile. These parameters can be altered with the Configuration tool.</p>
<h4><a name="MiniTOCBookMark7" id="MiniTOCBookMark7"></a>Command Parameters</h4>
<p>Command parameters are in the Configuration Services section with the following names and default values.</p>
<p>wmi_iis_bytes_received</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Uses check_nrpe plugin to connect to NRPE on $USER21$ and execute the get_iis_bytes_received command as defined in the nrpe.cfg against the host $HOSTADDRESS$.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default web server instance is _Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG1$ - Instance, e.g. Name=_Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default warning threshold for number of bytes received 6000</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG2$ - Warning number</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default critical threshold for number of bytes received 12000</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG3$ - Critical number</p>
</li>
</ul>
<p>wmi_iis_bytes_sent</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Uses check_nrpe plugin to connect to NRPE on $USER21$ and execute the get_iis_bytes_sent command as defined in the nrpe.cfg against the host $HOSTADDRESS$.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default web server instance is _Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG1$ - Instance, e.g. Name=_Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default warning threshold for number of bytes sent 6000000</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG2$ - Warning number</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default critical threshold for number of bytes sent 12000000</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG3$ - Critical number</p>
</li>
</ul>
<p>wmi_iis_bytes_total</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Uses check_nrpe plugin to connect to NRPE on $USER21$ and execute the get_iis_bytes_total command as defined in the nrpe.cfg against the host $HOSTADDRESS$.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default web server instance is _Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG1$ - Instance, e.g. Name=_Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default warning threshold for number of bytes total 500000</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG2$ - Warning number</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default critical threshold for number of bytes total 600000</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG3$ - Critical number</p>
</li>
</ul>
<p>wmi_iis_current_connections</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Uses check_nrpe plugin to connect to NRPE on $USER21$ and execute the get_iis_currentconnections command as defined in the nrpe.cfg against the host $HOSTADDRESS$.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default web server instance is _Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG1$ - Instance, e.g. Name=_Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default warning threshold for number of current connections 200</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG2$ - Warning number</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default critical threshold for number of current connections 400</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG3$ - Critical number</p>
</li>
</ul>
<p>wmi_iis_current_nonanonymous_users</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Uses check_nrpe plugin to connect to NRPE on $USER21$ and execute the get_iis_curnonanonusers command as defined in the nrpe.cfg against the host $HOSTADDRESS$.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default web server instance is _Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG1$ - Instance, e.g. Name=_Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default warning threshold for number of current users 50</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG2$ - Warning number</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default critical threshold for number of current users 80</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG3$ - Critical number</p>
</li>
</ul>
<p>wmi_iis_get_requests</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Uses check_nrpe plugin to connect to NRPE on $USER21$ and execute the get_iis_get_requests command as defined in the nrpe.cfg against the host $HOSTADDRESS$.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default web server instance is _Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG1$ - Instance, e.g. Name=_Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default warning threshold for number of get requests per second 200</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG2$ - Warning number</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default critical threshold for number of get requests per second 400</p>
</li>
<li class="P-Bullet1">
<p class="Bullet2">$ARG3$ - Critical number</p>
</li>
</ul>
<p>wmi_iis_maximum_connections</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Uses check_nrpe plugin to connect to NRPE on $USER21$ and execute the get_iis_maximumconnections command as defined in the nrpe.cfg against the host $HOSTADDRESS$.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default web server instance is _Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG1$ - Instance, e.g. Name=_Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default warning threshold for number of current connections 50</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG2$ - Warning number</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default critical threshold for number of current connections 60</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG3$ - Critical number</p>
</li>
</ul>
<p>wmi_iis_post_requests</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Uses check_nrpe plugin to connect to NRPE on $USER21$ and execute the get_iis_post_requests command as defined in the nrpe.cfg against the host $HOSTADDRESS$.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default web server instance is _Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG1$ - Instance, e.g. Name=_Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default warning threshold for number of post requests per second 200</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG2$ - Warning number</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default critical threshold for number of post requests per second 400</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG3$ - Critical number</p>
</li>
</ul>
<p>wmi_iis_private_bytes</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Uses check_nrpe plugin to connect to NRPE on $USER21$ and execute the get_iis_privatebytes command as defined in the nrpe.cfg against the host $HOSTADDRESS$.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default warning threshold for size of IIS private bytes 4000000</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG1$ - Warning number</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default critical threshold for size of IIS private bytes 5000000</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG2$ - Critical number</p>
</li>
</ul>
<p>wmi_iis_total_not_found</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Uses check_nrpe plugin to connect to NRPE on $USER21$ and execute the get_iis_totalnotfounderrors command as defined in the nrpe.cfg against the host $HOSTADDRESS$.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default web server instance is _Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG1$ - Instance, e.g. Name=_Total</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default warning threshold for number of not found errors 500</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG2$ - Warning number</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Default critical threshold for number of current connections 600</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG3$ - Critical number</p>
</li>
</ul>
<p>wmi_service</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Uses check_nrpe plugin to connect to NRPE on $USER21$ and execute the get_service command as defined in the nrpe.cfg against the host $HOSTADDRESS$.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">$ARG1$ - Service Name (not Display Name!)</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">OK if service is running</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">CRITICAL is service is stopped.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">UNKNOWN is service is not installed.</p>
</li>
</ul>
<h4><a name="MiniTOCBookMark8" id="MiniTOCBookMark8"></a>Performance Graphing Parameters</h4>
<p>The following parameters are used to generate performance charts. These parameters are set using the Configuration&gt;Performance tool in GroundWork Monitor.</p>
<p>wmi_iis_bytes_received</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Graphs the number of bytes the web server received per second.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Nagios service description must contain the string iis_bytes_received.</p>
</li>
</ul>
<p>wmi_iis_bytes_sent</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Graphs the number of bytes the web server sent per second.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Nagios service description must contain the string iis_bytes_received.</p>
</li>
</ul>
<p>wmi_iis_bytes_total</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Graphs the number of bytes the web server sent and received per second.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Nagios service description must contain the string iis_bytes_received.</p>
</li>
</ul>
<p>wmi_iis_current_connections</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Graphs the number of connections to the web server.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Nagios service description must contain the string iis_bytes_received.</p>
</li>
</ul>
<p>wmi_iis_current_nonanonymous_users</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Graphs the number of nonanonymous users connected to the web server.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Nagios service description must contain the string iis_bytes_received.</p>
</li>
</ul>
<p>wmi_iis_get_requests</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Graphs the number of get requests per second to the web server.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Nagios service description must contain the string iis_bytes_received.</p>
</li>
</ul>
<p>wmi_iis_maximum_connections</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Graphs the maximum number of connections the web server has had since starting.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Nagios service description must contain the string iis_bytes_received.</p>
</li>
</ul>
<p>wmi_iis_post_requests</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Graphs the number of post requests per second to the web server.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Nagios service description must contain the string iis_bytes_received.</p>
</li>
</ul>
<p>wmi_iis_private_bytes</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Graphs the number of private bytes the inetinfo process is using.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Nagios service description must contain the string iis_bytes_received.</p>
</li>
</ul>
<p>wmi_iis_total_not_found_errors</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">Graphs the number of not found errors since the web server has started.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">Nagios service description must contain the string iis_bytes_received.</p>
</li>
</ul>
<h4><a name="MiniTOCBookMark9" id="MiniTOCBookMark9"></a>Implementation Notes</h4>
<p>The steps are:</p>
<ul>
<li class="P-Bullet1">
<p class="Bullet1">The <span class="CodeInline">nrpe.cfg</span> file on the Windows server maps commands issued by the GroundWork server to scripts in the <span class="CodeInline">c:\nrpe_nt</span> directory. Commands issued by this profile are installed with this package. If new NRPE commands are added, this file must be modified. Go to the <span style="font-style: italic;"><i>GroundWork Support Portal</i></span> - <span style="font-style: italic;"><i>GroundWork Connect</i></span> at <a href="http://www.groundworkconnect.com" target="_blank">www.groundworkconnect.com</a> and search for <span style="font-style: italic; font-weight: bold;"><i><b>Installing GroundWork WMI NRPE</b></i></span>.</p>
</li>
<li class="P-Bullet1">
<p class="Bullet1">The WMI proxy server must be in the same domain as target monitored Windows server, and must have administrator rights.</p>
</li>
</ul>
<div style="width: 100%; position: relative;" id="footer">
<p class="Footer" style="font-size: 7pt; line-height: Normal; margin-top: 6pt; margin-bottom: 4pt;">GroundWork, Inc. ©2011</p>
</div>
<script type="text/javascript" language="javascript1.2">
//<![CDATA[
<!--
if (window.writeIntopicBar)
        writeIntopicBar(0);


highlightSearch();
//-->
//]]>
</script>
</body>
</html>
