<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0014)about:internet -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Adobe RoboHelp 8" />
<title>Weekly Maintenance</title>
<link rel="StyleSheet" href="../Bookshelf.css" type="text/css" />
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function ehlp_showtip(current,e,text)
{
  if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == 'Netscape'))
  {
    document.tooltip.document.write("<layer bgColor='yellow' style='border:1px solid black;font-size:12px;'>"+ text + "<\/layer>");
    document.tooltip.document.close();
    document.tooltip.left=e.pageX+5;
    document.tooltip.top=e.pageY+5;
    document.tooltip.visibility="show";
  }
}
function ehlp_hidetip()
{
  document.tooltip.visibility="hidden";
}
//]]>
</script>
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
        origWidth = innerWidth;
        origHeight = innerHeight;
        onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
/*<![CDATA[*/
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
-->
/*]]>*/
</style>

<script type="text/javascript" language="javascript1.2" src="../whmsg.js">
</script>
<script type="text/javascript" language="javascript" src="../whver.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../whproxy.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../whutils.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../whlang.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../whtopic.js">
</script>
</head>
<body>
<script type="text/javascript" language="javascript1.2">
//<![CDATA[
<!--
if (window.gbWhTopic)
{
        var strUrl = document.location.href;
        var bc = 0;
        var n = strUrl.toLowerCase().indexOf("bc-");
        if(n != -1)
        {
                document.location.href = strUrl.substring(0, n);
                bc = strUrl.substring(n+3);
        }

        if (window.addTocInfo)
        {
        addTocInfo("SYSTEM MAINTENANCE\nWeekly Maintenance");
addButton("show",BTN_TEXT,"Show Table of Contents","","","","",0,0,"","","");

        }
        if (window.writeBtnStyle)
                writeBtnStyle();

        if (window.writeIntopicBar)
                writeIntopicBar(1);

        
        

        if (window.setRelStartPage)
        {
        setRelStartPage("../Bookshelf.htm");

                autoSync(0);
                sendSyncInfo();
                sendAveInfoOut();
        }
}
else
        if (window.gbIE4)
                document.location.reload();

//-->
//]]>
</script><script type="text/javascript" language="JavaScript1.2" src="../ehlpdhtm.js">
</script><script type="text/javascript" language="javascript">
//<![CDATA[
document.write("<p  style=\"text-align:right;color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;\">");
AddMasterBreadcrumbs("../Bookshelf.htm", "color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;", "&gt;", "Home", "../Welcome_to_GroundWork_Monitor/index.htm");
document.write("<a style=\"color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;\" href=\"systemmaintenance_aboutsystemmaintenance.htm\">SYSTEM MAINTENANCE<\/a> &gt; Weekly Maintenance<\/p>");
//]]>
</script>
<p>&#160;</p>
<h1><a name="MiniTOCBookMark1" id="MiniTOCBookMark1"></a><img src="../Shared_Images/square.gif" alt="square.gif" style="border: none;" width="15" height="15" border="0" /> System Maintenance</h1>
<h3 align="right"><a href="systemmaintenance_aboutsystemmaintenance.htm" title="Topic Home" onmouseover="if ((parseInt(navigator.appVersion) == 4) &amp;&amp; (navigator.appName == 'Netscape')) ehlp_showtip(this,event,'Topic Home');" onmouseout="if ((parseInt(navigator.appVersion) == 4) &amp;&amp; (navigator.appName == 'Netscape')) ehlp_hidetip();"><img src="../Shared_Images/homeicon.gif" alt="homeicon.gif" style="border: none;" width="33" height="27" border="0" /></a> <img src="../Shared_Images/printicon.gif" onclick="window.print()" alt="Print Page" title="Print Page" style="border: none;" width="31" height="27" border="0" /> <a href="mailto:support@groundworkopensource.com?subject=Weekly Maintenance for a GroundWork Monitor Installation" title="Send Comments"><img src="../Shared_Images/commentsicon.gif" alt="commentsicon.gif" style="border: none;" width="33" height="27" border="0" /></a></h3>
<h2><a name="MiniTOCBookMark2" id="MiniTOCBookMark2"></a>Weekly Maintenance</h2>
<p align="left">Table&#160;of&#160;Contents:&#160;<a class="dropspot" href="javascript:TextPopup(this)" id="MTHotSpot31534" name="MTHotSpot31534"><span class="MTText">Show</span><span class="MTText" style="display: none;">Hide</span></a></p>
<script type="text/javascript" language="JavaScript1.2">
//<![CDATA[
TextPopupInit('MTHotSpot31534', 'MTPOPUP31534');
//]]>
</script>
<div align="left" class="droptext" id="MTPOPUP31534" style="display: none;">
<ul style="text-align:left; list-style-type: circle;">
<li><a href="#MiniTOCBookMark3">Step 1 - Notify Users</a></li>
<li><a href="#MiniTOCBookMark4">Step 2 - Shell Access</a></li>
<li><a href="#MiniTOCBookMark5">Step 3 - Stop All Services</a></li>
<li><a href="#MiniTOCBookMark6">Step 4 - Backup Databases and Configuration Settings</a></li>
<li><a href="#MiniTOCBookMark13">Step 5 - Purge Session Files and Old Backups</a></li>
<li><a href="#MiniTOCBookMark14">Step 6 - Restart All Services</a></li>
</ul>
</div>
<p>The <span style="font-style: italic;"><i>Table of Contents</i></span> above, lists the steps of recommended weekly procedures for backing up your <span style="font-style: italic;"><i>GroundWork Monitor</i></span> system including steps to backup database and configuration settings.</p>
<p><span style="color: #ff0000; font-weight: bold;"><font color="red"><b>Note:</b></font></span> It is recommended practice to backup the <span style="font-style: italic;"><i>GroundWork</i></span> databases and the configuration file at least once a week so that a system can be quickly restored from a disaster or system failure. It's up to the System Administrator to decide how long backups should be stored. Additionally, it is highly recommended to backup the backup directory on an external device. The weekly maintenance consists of six steps outlined in the Table of Contents.</p>
<h3><a name="MiniTOCBookMark3" id="MiniTOCBookMark3"></a>Step 1 - Notify Users</h3>
<p class="Numbering">As the first step, you will need to notify the GroundWork Monitor system users of the system maintenance and ask them to log out otherwise they will receive unexpected errors.</p>
<p class="Numbering">You can schedule a maintenance window and notify all GroundWork Monitor system users that the system will be unavailable for a short time. All users should log out of the application otherwise the will receive error messages and will loose their current session.</p>
<h3 class="Numbering"><a name="MiniTOCBookMark4" id="MiniTOCBookMark4"></a>Step 2 - Shell Access</h3>
<p class="Numbering">Next, you will need to get shell access to the GroundWork server. You can do this either by opening a shell on the sever or get remote access with through ssh. Make sure that you are user <span class="CodeInline">root</span> to execute all commands.</p>
<h3 class="Numbering"><a name="MiniTOCBookMark5" id="MiniTOCBookMark5"></a>Step 3 - Stop All Services</h3>
<p class="Numbering">Next, stop all services used by GroundWork Monitor with their respective commands:</p>
<p class="NormalIndent1" style="font-weight: bold;"><span style="font-weight: normal;">gwservices:</span> <span class="CodeInline">/usr/local/groundwork/ctlscript.sh stop gwservices</span></p>
<p class="NormalIndent1" style="font-weight: bold;"><span style="font-weight: normal;">Nagios deamon:</span> <span class="CodeInline">/usr/local/groundwork/ctlscript.sh stop</span> <span class="CodeInline" style="font-weight: bold;"><b>nagios</b></span></p>
<p class="NormalIndent1" style="font-weight: bold;"><span style="font-weight: normal;">httpd:</span> <span class="CodeInline">/usr/local/groundwork/ctlscript.sh stop apache</span></p>
<p class="NormalIndent1" style="font-weight: bold;"><span style="font-weight: normal;">snmptrapd and snmpttd:</span> <span class="CodeInline">/usr/local/groundwork/ctlscript.sh stop snmpttd</span></p>
<p class="NormalIndent1" style="font-weight: bold;"><span style="font-weight: normal;">syslog-ng:</span> <span class="CodeInline">/usr/local/groundwork/ctlscript.sh stop syslog-ng</span></p>
<h3><a name="MiniTOCBookMark6" id="MiniTOCBookMark6"></a>Step 4 - Backup Databases and Configuration Settings</h3>
<h4><a name="MiniTOCBookMark7" id="MiniTOCBookMark7"></a>GroundWork Databases</h4>
<p class="Numbering">Issue the following commands to backup all GroundWork databases:</p>
<p><span style="color: #ff0000; font-weight: bold;"><font color="red"><b>Note:</b></font></span> You will be prompted for a password for the <span style="font-style: italic;"><i>postgres</i></span> user. In the example below, <span class="CodeInline">monarch_backup_09012009.sql</span> is the database backup file name where <span class="CodeInline">09012009</span> is the current date.</p>
<p class="CodeGroup">pg_dump -f /usr/local/groundwork/backup/monarch-11172011.sql.tar -F t -c -E LATIN1 monarch</p>
<p class="CodeGroup">pg_dump -f /usr/local/groundwork/backup/gwcollagedb-11172011.sql.tar -F t -c -E LATIN1 gwcollagedb</p>
<p class="CodeGroup">pg_dump -f /usr/local/groundwork/backup/dashboard-11172011.sql.tar -F t -c -E LATIN1 dashboard</p>
<p class="CodeGroup">pg_dump -f /usr/local/groundwork/backup/jbossportal-11172011.sql.tar -F t -c -E LATIN1 jbossportal</p>
<p class="CodeGroup">pg_dump -f /usr/local/groundwork/backup/jbossdb-11172011.sql.tar -F t -c -E LATIN1 jbossdb</p>
<h4><a name="MiniTOCBookMark8" id="MiniTOCBookMark8"></a>System Configuration Settings</h4>
<p class="Numbering">Issue the following commands to backup the system configuration settings for Foundation and Nagios:</p>
<p class="CodeGroup">tar -czf &#160;/usr/local/groundwork/backup/foundation_config_backup.tar.gz /usr/local/groundwork/config/*</p>
<p class="CodeGroup">tar -czf &#160;/usr/local/groundwork/backup/nagios_config_backup.tar.gz /usr/local/groundwork/nagios/etc/*</p>
<h4><a name="MiniTOCBookMark9" id="MiniTOCBookMark9"></a>GroundWork Profiles</h4>
<p>Issue the following commands to backup GroundWork Profiles:</p>
<p class="CodeGroup">tar -czf /usr/local/groundwork/backup/profiles_backup.tar.gz /usr/local/groundwork/profiles/*</p>
<h4><a name="MiniTOCBookMark10" id="MiniTOCBookMark10"></a>Customized Monarch Modules</h4>
<p>Issues the following commands to backup customized Monarch modules:</p>
<p class="CodeGroup">tar -czf /usr/local/groundwork/backup/monarch_callout_backup.tar.gz /usr/local/groundwork/core/monarch/lib/MonarchCallOut.pm</p>
<p class="CodeGroup">tar -czf /usr/local/groundwork/backup/monarch_deploy_backup.tar.gz /usr/local/groundwork/core/monarch/lib/MonarchDeploy.pm</p>
<p class="CodeGroup">tar -czf /usr/local/groundwork/backup/monarch_external_backup.tar.gz /usr/local/groundwork/core/monarch/lib/MonarchExternals.pm</p>
<h4><a name="MiniTOCBookMark11" id="MiniTOCBookMark11"></a>Automation Scripts and Templates</h4>
<p>Issue the following commands to backup Monarch automation Scripts and Templates:</p>
<p class="CodeGroup">tar -czf /usr/local/groundwork/backup/automation_scripts_backup.tar.gz /usr/local/groundwork/automation/scripts/*</p>
<p class="CodeGroup">tar -czf /usr/local/groundwork/backup/automation_templates_backup.tar.gz /usr/local/groundwork/automation/templates/*</p>
<h4><a name="MiniTOCBookMark12" id="MiniTOCBookMark12"></a>JBoss Configuration Files</h4>
<p>JBoss configuration files are all stored in the directory: <span class="CodeInline">/usr/local/groundwork/config</span></p>
<p class="CodeGroup">tar -czf /usr/local/groundwork/jboss-config .tar.gz/usr/local/groundwork/config/jboss/*</p>
<p class="CodeGroup">tar -czf /usr/local/groundwork/jboss-config-xml .tar.gz/usr/local/groundwork/config/*jboss*.xml</p>
<h3><a name="MiniTOCBookMark13" id="MiniTOCBookMark13"></a>Step 5 - Purge Session Files and Old Backups</h3>
<p class="Numbering">This step covers purging old session files and backup data that can be rotated.</p>
<p class="Numbering">Delete temporary session files with the commands:</p>
<p class="CodeGroup">rm -rf /tmp/sess*</p>
<p class="CodeGroup">rm -rf /tmp/tpl*</p>
<p class="Numbering">If you have decided to keep backups for more than a month the following command will purge any backup files older than 28 days:</p>
<p class="CodeGroup">find /usr/local/groundwork/backup/ -mtime +28 -exec /bin/rm -rf {} \;</p>
<h3><a name="MiniTOCBookMark14" id="MiniTOCBookMark14"></a>Step 6 - Restart All Services</h3>
<p class="Numbering">Next, you will need to restart all services used by GroundWork Monitor with their respective commands:</p>
<p class="NormalIndent1" style="font-weight: normal;">gwservices: <span class="CodeInline">/usr/local/groundwork/ctlscript.sh start gwservices</span></p>
<p class="NormalIndent1" style="font-weight: bold;"><span style="font-weight: normal;">Nagios deamon:</span> <span class="CodeInline">/usr/local/groundwork/ctlscript.sh start nagios</span></p>
<p class="NormalIndent1" style="font-weight: bold;"><span style="font-weight: normal;">httpd:</span> <span class="CodeInline">/usr/local/groundwork/ctlscript.sh start apache</span></p>
<p class="NormalIndent1" style="font-weight: bold;"><span style="font-weight: normal;">snmptrapd and snmpttd:</span> <span class="CodeInline">/usr/local/groundwork/ctlscript.sh start snmpttd</span></p>
<p class="NormalIndent1" style="font-weight: bold;"><span style="font-weight: normal;">syslog-ng:</span> <span class="CodeInline">/usr/local/groundwork/ctlscript.sh start syslog-ng</span></p>
<div style="width: 100%; position: relative;" id="footer">
<p class="Footer" style="font-size: 7pt; line-height: Normal; margin-top: 6pt; margin-bottom: 4pt;">GroundWork, Inc. ©2011</p>
</div>
<script type="text/javascript" language="JavaScript">
//<![CDATA[
 if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == 'Netscape'))
  document.write("<div id='tooltip' class='WebHelpPopupMenu'><\/div>");
//]]>
</script><script type="text/javascript" language="javascript1.2">
//<![CDATA[
<!--
if (window.writeIntopicBar)
        writeIntopicBar(0);


highlightSearch();
//-->
//]]>
</script>
</body>
</html>
