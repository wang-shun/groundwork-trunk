<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0014)about:internet -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Adobe RoboHelp 8" />
<title>NMS Weathermap</title>
<link rel="StyleSheet" href="../../../../Bookshelf.css" type="text/css" />
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function ehlp_showtip(current,e,text)
{
  if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == 'Netscape'))
  {
    document.tooltip.document.write("<layer bgColor='yellow' style='border:1px solid black;font-size:12px;'>"+ text + "<\/layer>");
    document.tooltip.document.close();
    document.tooltip.left=e.pageX+5;
    document.tooltip.top=e.pageY+5;
    document.tooltip.visibility="show";
  }
}
function ehlp_hidetip()
{
  document.tooltip.visibility="hidden";
}
//]]>
</script>
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
        origWidth = innerWidth;
        origHeight = innerHeight;
        onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
/*<![CDATA[*/
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
-->
/*]]>*/
</style>

<script type="text/javascript" language="javascript1.2" src="../../../../whmsg.js">
</script>
<script type="text/javascript" language="javascript" src="../../../../whver.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../../../../whproxy.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../../../../whutils.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../../../../whlang.js">
</script>
<script type="text/javascript" language="javascript1.2" src="../../../../whtopic.js">
</script>
</head>
<body>
<script type="text/javascript" language="javascript1.2">
//<![CDATA[
<!--
if (window.gbWhTopic)
{
        var strUrl = document.location.href;
        var bc = 0;
        var n = strUrl.toLowerCase().indexOf("bc-");
        if(n != -1)
        {
                document.location.href = strUrl.substring(0, n);
                bc = strUrl.substring(n+3);
        }

        if (window.addTocInfo)
        {
        addTocInfo("USING APPLICATIONS\nAdvanced\nGroundWork NMS\nNMS Weathermap");
addButton("show",BTN_TEXT,"Show Table of Contents","","","","",0,0,"","","");

        }
        if (window.writeBtnStyle)
                writeBtnStyle();

        if (window.writeIntopicBar)
                writeIntopicBar(1);

        
        

        if (window.setRelStartPage)
        {
        setRelStartPage("../../../../Bookshelf.htm");

                autoSync(0);
                sendSyncInfo();
                sendAveInfoOut();
        }
}
else
        if (window.gbIE4)
                document.location.reload();

//-->
//]]>
</script><script type="text/javascript" language="JavaScript1.2" src="../../../../ehlpdhtm.js">
</script><script type="text/javascript" language="javascript">
//<![CDATA[
document.write("<p  style=\"text-align:right;color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;\">");
AddMasterBreadcrumbs("../../../../Bookshelf.htm", "color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;", "&gt;", "Home", "../../../../Welcome_to_GroundWork_Monitor/index.htm");
document.write("<a style=\"color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;\" href=\"../../../usingapplications_aboutusingapplications.htm\">USING APPLICATIONS<\/a> &gt; <a style=\"color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;\" href=\"../../nagios_usingthenagiosinterface.htm\">Advanced<\/a> &gt; <a style=\"color:#0000ff;font-family:Arial;font-size:7pt;font-weight: normal;font-style: normal;text-decoration: none;\" href=\"../nms_aboutnms.htm\">GroundWork NMS<\/a> &gt; NMS Weathermap<\/p>");
//]]>
</script>
<p>&#160;</p>
<h1><a name="MiniTOCBookMark1" id="MiniTOCBookMark1"></a><img src="../../../../Shared_Images/square.gif" alt="square.gif" style="border: none;" width="15" height="15" border="0" /> GroundWork Network Management Suite (NMS)</h1>
<h3 align="right"><a href="../nms_aboutnms.htm" title="Topic Home" onmouseover="if ((parseInt(navigator.appVersion) == 4) &amp;&amp; (navigator.appName == 'Netscape')) ehlp_showtip(this,event,'Topic Home');" onmouseout="if ((parseInt(navigator.appVersion) == 4) &amp;&amp; (navigator.appName == 'Netscape')) ehlp_hidetip();"><img src="../../../../Shared_Images/homeicon.gif" alt="Topic Home" title="Topic Home" style="border: none;" width="33" height="27" border="0" /></a> <img src="../../../../Shared_Images/printicon.gif" onclick="window.print()" alt="Print Page" title="Print Page" style="border: none;" width="33" height="27" border="0" /> <a href="mailto:support@groundworkopensource.com?subject=NMS Weathermap" title="Send Comments"><img src="../../../../Shared_Images/commentsicon.gif" alt="Send Comments" title="Send Comments" style="border: none;" width="33" height="27" border="0" /></a></h3>
<span class="PageTitle">NMS Weathermap</span>
<p align="left">Table&#160;of&#160;Contents:&#160;<a class="dropspot" href="javascript:TextPopup(this)" id="MTHotSpot20151" name="MTHotSpot20151"><span class="MTText">Show</span><span class="MTText" style="display: none;">Hide</span></a></p>
<script type="text/javascript" language="JavaScript1.2">
//<![CDATA[
TextPopupInit('MTHotSpot20151', 'MTPOPUP20151');
//]]>
</script>
<div align="left" class="droptext" id="MTPOPUP20151" style="display: none;">
<ul style="text-align:left; list-style-type: circle;">
<li style="margin-left: 0px;margin-top: 0px;"><a href="#MiniTOCBookMark2">About Weathermap</a></li>
<li style="margin-left: 0px;margin-top: 0px;"><a href="#MiniTOCBookMark3">Configuring the Weathermap Package</a>
<ul style="list-style-type: circle;">
<li style="margin-left: 0px;margin-top: 0px;"><a href="#MiniTOCBookMark4">Managing User Access</a></li>
<li style="margin-left: 0px;margin-top: 0px;"><a href="#MiniTOCBookMark5">Setting the Editor Defaults</a></li>
<li style="margin-left: 0px;margin-top: 0px;"><a href="#MiniTOCBookMark6">Automating the Map Generator</a></li>
</ul>
</li>
<li style="margin-left: 0px;margin-top: 0px;"><a href="#MiniTOCBookMark7">Using the Weathermap Editor</a>
<ul style="list-style-type: circle;">
<li style="margin-left: 0px;margin-top: 0px;"><a href="#MiniTOCBookMark8">Setting Map Properties</a></li>
<li style="margin-left: 0px;margin-top: 0px;"><a href="#MiniTOCBookMark9">Managing Map Devices</a></li>
<li style="margin-left: 0px;margin-top: 0px;"><a href="#MiniTOCBookMark10">Managing Device Links</a></li>
</ul>
</li>
<li style="margin-left: 0px;margin-top: 0px;"><a href="#MiniTOCBookMark11">Integrating Maps with GroundWork Monitor</a></li>
</ul>
</div>
<h2><a name="MiniTOCBookMark2" id="MiniTOCBookMark2"></a>About Weathermap</h2>
<p>The GroundWork NMS Weathermap package is an open source toolkit for creating dynamic maps of network traffic, and is integrated into GroundWork Monitor as an optional component of the GroundWork Network Management System (NMS). When the GroundWork NMS Weathermap package has been installed, a "Weathermap Editor" menu item will be present in the main drop-down menu.</p>
<p>In simple terms, Weathermap is an integrated toolkit for creating overhead maps that display the network traffic levels between selected devices. Whereas most of the components in GroundWork Monitor are designed for the purpose of monitoring the devices on a network (such as measuring the available resources on a host and then generating alarms when conditions require it), Weathermap is designed to help administrators visualize the traffic between network devices.</p>
<p>More specifically, the graphing component of Weathermap uses user-generated configuration files to build dynamic graphical maps of a network—including the nodes and links on a network—and then reads existing databases of network traffic to display the traffic levels on each link. Meanwhile, the editing component of Weathermap provides a web-based graphical front-end to the configuration files, and allows users to build the maps quickly and easily.</p>
<p>Weathermap is primarily intended to be used with the GroundWork Cacti package, which provides direct support for executing the Weathermap graphing component through a plug-in. However, Weathermap generates maps as PNG images with DHTML wrappers that provide interactive features such as hyperlinks and pop-up charts, so the map output can be used anywhere that a web page or PNG image can be used. For example, the resulting maps can be used to provide a background image for a GroundWork Dashboard applet, if the user wishes to do so.</p>
<p>This document discusses the basic configuration and operation of Weathermap. For more detailed discussion, refer to the <a href="http://www.network-weathermap.com/manual/latest/pages/main.html" target="_blank">online Weathermap documentation</a>.</p>
<h2><a name="MiniTOCBookMark3" id="MiniTOCBookMark3"></a>Configuring the Weathermap Package</h2>
<p>The GroundWork NMS Weathermap package is installed separately from GroundWork Monitor and other applications, and also has its own unique configuration process.</p>
<h3><a name="MiniTOCBookMark4" id="MiniTOCBookMark4"></a>Managing User Access</h3>
<p>The Weathermap web pages are provided by a NMS-specific instance of Apache, although the Weathermap web front-end is also integrated into GroundWork Monitor through the use of the JBoss Portal. As such, users who have been granted the appropriate role-based permission to access the Weathermap object can do so by logging into GroundWork Monitor, and then choosing the "Weathermap" entry from the main drop-down menu.</p>
<p>Weathermap does not provide any user accounts or access controls itself, although you can restrict access to the map editor with GroundWork role privileges, and you can also restrict access to the Weathermap plug-in for Cacti from within Cacti as well. For information on configuring user access to the "Weathermap" menu item, refer to the "Configuring Roles" section of the Administration documentation. Refer to the NMS Cacti chapter for more information on the Weathermap plug-in for Cacti.</p>
<h3><a name="MiniTOCBookMark5" id="MiniTOCBookMark5"></a>Setting the Editor Defaults</h3>
<p>By default, the Weathermap Editor uses internal defaults and compile-time switches to determine program behavior. However, the program is able to use a configuration file to override some of the predefined settings, if needed. By default, the configuration file does not exist and must be created, although a sample configuration file is provided which can be copied into place. The sample configuration file is <span class="CodeInline">/usr/local/groundwork/nms/applications/cacti/plugins/weathermap/editor-config.php-dist</span>, which can be renamed to <span class="CodeInline">editor-config.php</span> once it has been edited to reflect your specific requirements.</p>
<p>Note that the Weathermap <span class="CodeInline">generator</span> does not use a configuration file for the program itself, but instead uses command-line switches and the map control files to determine the map behavior. For information on the important command-line switches to the map generator, refer to the Automating the Map Generator section below.</p>
<h3><a name="MiniTOCBookMark6" id="MiniTOCBookMark6"></a>Automating the Map Generator</h3>
<p>Since the graphical maps that are generated by Weathermap use static PNG files, they only represent the network state at the moment they are created. In order to keep the map files up to date, they must be regenerated somewhat frequently.</p>
<p>Normally this process is handled by the Weathermap plug-in for Cacti, which executes the Weathermap generator during every polling run (once every five minutes by default). However, you can also automate the map creation separately by adding the program to the <span class="CodeInline">nagios</span> user's <span class="CodeInline">crontab</span> file. To do this, perform the following steps:</p>
<ol>
<li class="p-Numbering">
<p class="Numbering">Login to the GroundWork server with root privileges.</p>
</li>
<li class="p-Numbering">
<p class="Numbering">From a command prompt, issue the "<span class="CodeInline">crontab -u nagios -e</span>" command to edit the crontab file associated with the <span class="CodeInline">nagios</span> account.</p>
</li>
<li class="p-Numbering">
<p class="Numbering">For each map that you want to automatically generate, create a separate crontab entry for the <span class="CodeInline">/usr/local/groundwork/nms/applications/cacti/plugins/weathermap/weathermap</span> program with the necessary command-line parameters (see below), and the desired time interval.</p>
</li>
<li class="p-Numbering">
<p class="Numbering">Save the <span class="CodeInline">crontab</span> file and exit the editor. The <span class="CodeInline">cron</span> daemon will automatically incorporate the new command-line parameters into its current schedule.</p>
</li>
</ol>
<p>Note that the map control files that are used by the Weathermap generator store all of the information that is needed to create the PNG and DHTLM output files, so the only necessary command-line argument is to identify the configuration file that should be read. However, you can also specify the output filenames on the command-line if necessary or desired.</p>
<p>The important command-line arguments are "<span class="CodeInline">--config &lt;filename&gt;</span>" (where <span style="font-style: italic;"><i>&lt;filename&gt;</i></span> is the path to the map configuration file that you want to process), "<span class="CodeInline">--output &lt;filename&gt;</span>" (where <span style="font-style: italic;"><i>&lt;filename&gt;</i></span> is the path to the desired image file), and "<span class="CodeInline">--htmloutput &lt;filename&gt;</span>" (where <span style="font-style: italic;"><i>&lt;filename&gt;</i></span> is the path to the desired HTML web page).</p>
<p>For a list of the available command-line parameters, execute the <span class="CodeInline">weathermap</span> program with the "<span class="CodeInline">--help</span>" command-line argument. For more information about the Weathermap command-line parameters, refer to the <a href="http://www.network-weathermap.com/manual/latest/pages/main.html" target="_blank">online Weathermap documentation</a>. For information on the Cacti plug-in, refer to the Cacti NMS chapter.</p>
<h2><a name="MiniTOCBookMark7" id="MiniTOCBookMark7"></a>Using the Weathermap Editor</h2>
<p>Although the map configuration files are simple text files that can be edited with any tool, Weathermap also includes a graphical, web-based editor that makes it easy to create simple maps. However, the editor is very lightweight and only has a handful of options, so building more complicated maps often requires additional editing.</p>
<p>To start the editor, click the "Weathermap Editor" menu item on the GroundWork Monitor main menu. You will then be presented with a startup dialog box similar to the following:</p>
<p><img src="Assets/weathermap-startup_0.gif" alt="Startup Dialog" title="Startup Dialog" style="border: none;" width="500" height="464" border="0" /></p>
<p>From the startup dialog, you can create a new map, make a copy of an existing map, or open an existing map for editing. To create a new map, type a name in the "Named:" edit box and click the "Create" button. To create and edit a copy of an existing map, type a name in the appropriate edit box, choose the original map from the drop-down list, and click the "Create Copy" button. To edit an existing map, click the hyperlinked map name from the list of files.</p>
<p>By default, the map configuration files are stored in and loaded from the <span class="CodeInline">/usr/local/groundwork/nms/applications/cacti/plugins/weathermap/configs</span> directory, and that is where the map generator and the Cacti plug-in will look for new maps. Note that the list of available maps includes a file called <span class="CodeInline">index.php</span>, which is used by the Apache web server, and is not a map file. <span style="color: #ff0000; font-weight: bold;"><font color="red"><b>Note:</b></font></span> <span style="text-decoration: underline;"><u>Do not</u></span> modify the <span class="CodeInline">index.php</span> file in the weathermap editor.</p>
<p>As can be seen, the map editor is not particular about file name extensions, and any file name extension can be used. However most maps have historically used a <span class="CodeInline">.conf</span> extension, and it's a good practice to use that syntax in case another program eventually requires it.</p>
<p>Once a map has been created or loaded for editing, the screen will be reloaded with the main editor window. From here you can add a device, add links between devices, add or move a bandwidth color legend, move the embedded timestamp, or modify the global map properties.</p>
<p>Note that the map files cannot be deleted from inside the editor.</p>
<h3><a name="MiniTOCBookMark8" id="MiniTOCBookMark8"></a>Setting Map Properties</h3>
<p>Each map has certain global settings that affect how the overall map appears. For example, each map has a title, a height and width, and so forth.</p>
<p>To set the global map properties, click the "Map Properties" menu item. A dialog box similar to the following will then be presented:</p>
<p><img src="Assets/weathermap-properties_0.gif" alt="Map Properties" title="Map Properties" style="border: none;" width="670" height="507" border="0" /></p>
<p>Note that the "Map Title" field essentially provides a description for the map, and does not appear on the map itself. Instead it is used as a file description, and is typically displayed next to the map somewhere (Cacti shows the title above the map, for example).</p>
<p>The size of the map can also be adjusted here if needed. Note that if you choose a background image, the map will inherit the image's dimensions and the values in the "Map Size" field will be ignored.</p>
<p>If you want to hard-code the output PNG and HTML files, you can do so here as well. However, this is not necessary unless you are planning to use the output files in another application. By default, the Cacti plug-in uses its own output naming rules.</p>
<h3><a name="MiniTOCBookMark9" id="MiniTOCBookMark9"></a>Managing Map Devices</h3>
<p>Weathermap "nodes" are used to represent the devices on the network, such as routers and hosts. They do not typically change appearance dynamically, although they can have dynamic properties such as mouse-over graphs.</p>
<p>To add a new device, click the "Add Node" menu item. The mouse cursor will change into a cross-hair, allowing you to click and place a device on the map. Once you place the device, a new boxed element labeled "Node" will appear on the map.</p>
<p>To manipulate the properties of a device, click once on the desired node element. A dialog box similar to the following will then be presented:</p>
<p><img src="Assets/weathermap-node-properties_0.gif" alt="Node Properties" title="Node Properties" style="border: none;" width="670" height="504" border="0" /></p>
<p>The "Internal Name" is a used as a node identifier within Weathermap itself and must be unique. The editor assigns a default identifier, but you can use your own values if you want to make the configuration file self-documenting.</p>
<p>The "Info URL" field stores a hyperlink for the node. When a user clicks on the node graphic, the specified URL will be opened in the web browser. By default, this field is overwritten with a relative URL that is based on the "Hover Graph URL" field below it, but it can link to any valid URL.</p>
<p>The "Hover Graph URL" field stores a URL for an object that should be displayed in a JavaScript pop-up whenever a user hovers their mouse cursor over the device (a good use for this is to show a CPU load graph, or some other kind of other dynamic data). The editor assumes that this will be a Cacti graph and provides a hyperlink for "[Pick from Cacti]" that lists all the known Cacti graph definitions. However, this can field can point to any graphic object that can be displayed in the user's web browser.</p>
<p>The "Icon Filename" field allows you to place a graphic element behind the node label. By default, the editor provides a list of the files in the "images" subdirectory, but you can use any image on the local computer that the <span class="CodeInline">nagios</span> user account has permission to access.</p>
<p>Note that the "Edit" button allows you to view and modify the actual configuration text for the selected device entry. If you need to override any of the default values (such as the icon path or the node's hyperlink), you can use this entry form.</p>
<p>To delete a node from the map, open the properties dialog for the device and click the "Delete" button.</p>
<h3><a name="MiniTOCBookMark10" id="MiniTOCBookMark10"></a>Managing Device Links</h3>
<p>Weathermap uses "links" to represent the network connections between nodes. The links will typically change color to reflect the amount of traffic being exchanged between those nodes, and they can also have dynamic properties such as mouse-over graphs.</p>
<p>To add a new link between two devices, click the "Add Link" menu item. The mouse cursor will change into a cross-hair, allowing you to click on a beginning device, and remain as a cross-hair until you also click the ending device. Once you place the link between the two nodes, a new element with arrows facing towards each other will appear on the map.</p>
<p>To manipulate the properties of a link, click once on the desired link element. A dialog box similar to the following will then be presented:</p>
<p><img src="Assets/weathermap-link-properties_0.gif" alt="Device Links" title="Device Links" style="border: none;" width="670" height="507" border="0" /></p>
<p>The "Maximum Bandwidth" setting is used to calculate the current load as a percentage, which is used by the weathermap generator to determine the link color.</p>
<p>The "Data Source" field is primarily used to point to a round-robin database (RRD) file that contains information about the traffic activity on the selected network link. Typically this is a Cacti data source for a specific network interface on a specific device, which includes individual fields for the amount of traffic that has been sent and received by that device. The weathermap generator then maps the sent and received data to the beginning and ending nodes associated with the link, thereby allowing it to correctly associate in-bound and out-bound traffic with the correct node.</p>
<p>The editor assumes that the "Data Source" will be a Cacti graph and provides a hyperlink for "[Pick from Cacti]" that lists all the known Cacti RRD files. However, this can field can point to any RRD file on the local computer that the <span class="CodeInline">nagios</span> user account has permission to access (such as RRD files that have been created by Nagios), and can also fetch data from sources other than RRD files with some extra effort. If you use a data source that is not a Cacti RRD, you will likely need to edit the configuration file by hand. For more information about the data sources that are available, refer to the <a href="http://www.network-weathermap.com/manual/latest/pages/main.html" target="_blank">online Weathermap documentation</a>.</p>
<p>The "Info URL" field stores a hyperlink for the link. When a user clicks on the link graphic, the specified URL will be opened in the web browser. By default, this field is overwritten with a relative URL that is based on the "Data Source" field above it, but it can link to any valid URL.</p>
<p>The "Hover Graph URL" field stores a URL for an object that should be displayed in a JavaScript pop-up whenever a user hovers their mouse cursor over the link. By default, this field is overwritten with a relative URL that is based on the "Data Source" field above it, but it can link to any graphic object that can be displayed in the user's web browser.</p>
<p>Note that the "Edit" button allows you to view and modify the actual configuration text for the selected link entry. If you need to override any of the default values, you can use this entry form.</p>
<p>To delete a link from the map, open the properties dialog for the link and click the "Delete" button.</p>
<h2><a name="MiniTOCBookMark11" id="MiniTOCBookMark11"></a>Integrating Maps with GroundWork Monitor</h2>
<p>At the present time, the GroundWork NMS Weathermap package does not include any tools for automatically integrating maps into other GroundWork applications. However, the GroundWork Cacti package does provide a plug-in that allows the maps to be displayed inside Cacti. Furthermore, GroundWork applications such as the Dashboard toolkit can use the PNG images generated by Weathermap, and it is feasible to automate some parts of this process.</p>
<p>For information on the Cacti plug-in, refer to the <a href="../Cacti/nms_gwnmscacti.htm">NMS Cacti</a> chapter.</p>
<div style="width: 100%; position: relative;" id="footer">
<p class="Footer" style="font-size: 7pt; line-height: Normal; margin-top: 6pt; margin-bottom: 4pt;">GroundWork, Inc. ©2011</p>
</div>
<script type="text/javascript" language="JavaScript">
//<![CDATA[
 if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == 'Netscape'))
  document.write("<div id='tooltip' class='WebHelpPopupMenu'><\/div>");
//]]>
</script><script type="text/javascript" language="javascript1.2">
//<![CDATA[
<!--
if (window.writeIntopicBar)
        writeIntopicBar(0);


highlightSearch();
//-->
//]]>
</script>
</body>
</html>
